(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),s=n(6),r=n.n(s),o=(n(12),n(1)),l=n(2),u=n(4),d=n(3),c=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"render",value:function(){var e={backgroundColor:"green",width:this.props.progress+"%",height:"100%"};return a.a.createElement("div",{style:{height:"20px",width:"100%",border:"1px solid black"}},a.a.createElement("div",{style:e}))}}]),n}(a.a.Component),f=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,e)).state={uploadId:null,offset:0,lastChunkNrSent:0,uploading:!1,failed:!1,uploadSpeed:20,chunkSize:1048576,maxChunkSizeCoefficient:20},i.styles={border:"1px solid red"},i}return Object(l.a)(n,[{key:"prepareInit",value:function(){var e="?";return e+="type=init",e+="&size="+String(this.props.file.size),e+="&name="+this.props.file.name,e+="&lastModified="+this.props.file.lastModified}},{key:"prepareChunk",value:function(){var e="?";return e+="type=chunk",e+="&offset="+String(this.state.offset),e+="&chunkNr="+String(this.state.lastChunkNrSent+1),e+="&uploadId="+this.state.uploadId}},{key:"prepareEnd",value:function(){var e="?";return e+="type=end",e+="&uploadId="+this.state.uploadId}},{key:"handleUpload",value:function(){var e=this,t=null;if(this.state.uploadId)if(this.state.offset<this.props.file.size){if(!this.state.uploading)return;var n=20/this.state.uploadSpeed;n>this.state.maxChunkSizeCoefficient&&(n=this.state.maxChunkSizeCoefficient);this.state.chunkSize;20971520,t=this.prepareChunk();var i=this.props.file.slice(this.state.offset,this.state.offset+20971520),a=(new Date).getTime();fetch(this.props.target+t,{method:"POST",body:i}).then((function(t){if(t.ok)return t.json();throw e.setState({failed:!0}),new Error("Upload failed")})).then((function(t){var n=(new Date).getTime();e.setState({uploadSpeed:n-a}),e.handleUpload()})).catch((function(e){console.log(e)})),this.setState({offset:this.state.offset+20971520}),this.setState({lastChunkNrSent:this.state.lastChunkNrSent+1})}else t=this.prepareEnd(),console.log("Sending end packet"),fetch(this.props.target+t).then((function(t){if(t.ok)return t.json();throw e.setState({failed:!0}),new Error("Upload failed")})).then((function(e){console.log("Uploaded")})).catch((function(e){console.log(e)}));else t=this.prepareInit(),console.log("sending init packet"),fetch(this.props.target+t).then((function(t){if(t.ok)return t.json();throw e.setState({failed:!0}),new Error("Init not accepted")})).then((function(t){e.setState({uploadId:t.uploadId}),e.handleUpload()})).catch((function(e){console.log(e)}))}},{key:"renderUploadButton",value:function(){var e=this;if(this.props.file&&!(this.state.offset>=this.props.file.size))return this.state.uploading?a.a.createElement("button",{onClick:function(){e.setState({uploading:!1})}},"Pause"):!this.state.uploading&&this.state.offset>0?a.a.createElement("button",{onClick:function(){e.setState({uploading:!0},e.handleUpload)}},"Continue"):a.a.createElement("button",{onClick:function(){e.setState({uploading:!0},e.handleUpload)}},"Upload")}},{key:"renderSelected",value:function(){if(this.props.file)return console.log(this.props.file),a.a.createElement("div",null,this.props.file.name)}},{key:"renderProgressBar",value:function(){if(this.state.uploading||0!==this.state.offset){if(this.state.failed)return a.a.createElement("div",null,"Upload failed");if(this.state.offset>=this.props.file.size)return a.a.createElement("div",null,"Finished uploading");var e=Math.round(this.state.offset/this.props.file.size*100);return a.a.createElement("div",null,a.a.createElement("div",{style:{width:"85%",float:"left",marginRight:"10px"}},a.a.createElement(c,{progress:e})),a.a.createElement("div",null,e,"% (",Number(this.state.offset/1073741824).toFixed(1)," of ",Number(this.props.file.size/1073741824).toFixed(1)," GB)"))}}},{key:"render",value:function(){return a.a.createElement("div",{style:this.styles},this.renderSelected(),this.renderUploadButton(),this.renderProgressBar())}}]),n}(a.a.Component),h=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this)).handleFileSelection=function(e){var t=i.state.selectedFiles;e:for(var n=0;n<e.target.files.length;n++){for(var a=0;a<t.length;a++)if(t[a].name===e.target.files[n].name){console.log("contains");continue e}t.push(e.target.files[n])}i.setState({selectedFiles:t})},i.state={selectedFiles:[]},i}return Object(l.a)(n,[{key:"fileIsUploaded",value:function(e){return"type=exists","&size="+String(this.props.file.size),"&name="+this.props.file.name,"&lastModified="+this.props.file.lastModified,!1}},{key:"renderInputField",value:function(){var e=this;return a.a.createElement("input",{type:"file",accept:"*/*",multiple:!0,onChange:function(t){e.handleFileSelection(t)}})}},{key:"renderUploadElements",value:function(){if(this.state.selectedFiles){for(var e=[],t=0;t<this.state.selectedFiles.length;t++){var n=t;e.push(a.a.createElement(f,{key:n,file:this.state.selectedFiles[t],target:"/library/upload/"}))}return a.a.createElement("div",null,e)}}},{key:"render",value:function(){return a.a.createElement("div",null,this.renderInputField(),this.renderUploadElements())}}]),n}(a.a.Component);var p=function(){return a.a.createElement(h,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,n){e.exports=n(13)}},[[7,1,2]]]);
//# sourceMappingURL=main.78337fb0.chunk.js.map