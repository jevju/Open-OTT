(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),s=n(6),r=n.n(s),o=(n(12),n(1)),l=n(2),u=n(4),c=n(3),d=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"render",value:function(){var e={backgroundColor:"green",width:this.props.progress+"%",height:"100%"};return i.a.createElement("div",{style:{height:"20px",width:"100%",border:"1px solid black"}},i.a.createElement("div",{style:e}))}}]),n}(i.a.Component),h=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={uploadId:null,offset:0,lastChunkNrSent:0,uploading:!1,uploadSpeed:20,chunkSize:1048576,maxChunkSizeCoefficient:2},a.styles={border:"1px solid red"},a}return Object(l.a)(n,[{key:"prepareInit",value:function(){var e="?";return e+="type=init",e+="&size="+String(this.props.file.size),e+="&name="+this.props.file.name,e+="&lastModified="+this.props.file.lastModified}},{key:"prepareChunk",value:function(){var e="?";return e+="type=chunk",e+="&offset="+String(this.state.offset),e+="&chunkNr="+String(this.state.lastChunkNrSent+1),e+="&uploadId="+this.state.uploadId}},{key:"prepareEnd",value:function(){var e="?";return e+="type=end",e+="&uploadId="+this.state.uploadId}},{key:"handleUpload",value:function(){var e=this;if(this.state.uploadId)if(this.state.offset<this.props.file.size){if(!this.state.uploading)return;var t=20/this.state.uploadSpeed;t>this.state.maxChunkSizeCoefficient&&(t=this.state.maxChunkSizeCoefficient);var n=this.state.chunkSize*t,a=(s=this.prepareChunk(),this.props.file.slice(this.state.offset,this.state.offset+n)),i=(new Date).getTime();fetch(this.props.target+s,{method:"POST",body:a}).then((function(e){return e.json()})).then((function(t){var n=(new Date).getTime();e.setState({uploadSpeed:n-i}),e.handleUpload()})),this.setState({offset:this.state.offset+n}),this.setState({lastChunkNrSent:this.state.lastChunkNrSent+1})}else{s=this.prepareEnd();console.log("Sending end packet"),fetch(this.props.target+s).then((function(e){return e.json()})).then((function(e){console.log(e)}))}else{var s=this.prepareInit();console.log("sending init packet"),fetch(this.props.target+s).then((function(t){if(t.ok)return t.json();throw e.setState({uploadId:"failed"}),new Error("Init not accepted")})).then((function(t){e.setState({uploadId:t.uploadId}),e.handleUpload()})).catch((function(e){console.log(e)}))}}},{key:"renderUploadButton",value:function(){var e=this;if(this.props.file&&!(this.state.offset>=this.props.file.size))return this.state.uploading?i.a.createElement("button",{onClick:function(){e.setState({uploading:!1})}},"Pause"):!this.state.uploading&&this.state.offset>0?i.a.createElement("button",{onClick:function(){e.setState({uploading:!0},e.handleUpload)}},"Continue"):i.a.createElement("button",{onClick:function(){e.setState({uploading:!0},e.handleUpload)}},"Upload")}},{key:"renderSelected",value:function(){if(this.props.file)return i.a.createElement("div",null,this.props.file.name)}},{key:"renderProgressBar",value:function(){if(this.state.uploading||0!=this.state.offset){if(this.state.offset>=this.props.file.size)return i.a.createElement("div",null,"Finished uploading");var e=Math.round(this.state.offset/this.props.file.size*100);return i.a.createElement("div",null,i.a.createElement("div",{style:{width:"85%",float:"left",marginRight:"10px"}},i.a.createElement(d,{progress:e})),i.a.createElement("div",null,e,"%"))}}},{key:"render",value:function(){return i.a.createElement("div",{style:this.styles},this.renderSelected(),this.renderUploadButton(),this.renderProgressBar())}}]),n}(i.a.Component),f=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this)).handleFileSelection=function(e){var t=a.state.selectedFiles;e:for(var n=0;n<e.target.files.length;n++){for(var i=0;i<t.length;i++)if(t[i].name==e.target.files[n].name){console.log("contains");continue e}t.push(e.target.files[n])}a.setState({selectedFiles:t})},a.state={selectedFiles:[]},a}return Object(l.a)(n,[{key:"renderInputField",value:function(){var e=this;return i.a.createElement("input",{type:"file",accept:"*/*",multiple:!0,onChange:function(t){e.handleFileSelection(t)}})}},{key:"renderUploadElements",value:function(){if(this.state.selectedFiles){for(var e=[],t=0;t<this.state.selectedFiles.length;t++){var n=t;e.push(i.a.createElement(h,{key:n,file:this.state.selectedFiles[t],target:"/upload/"}))}return i.a.createElement("div",null,e)}}},{key:"render",value:function(){return i.a.createElement("div",null,this.renderInputField(),this.renderUploadElements())}}]),n}(i.a.Component);var p=function(){return i.a.createElement(f,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,n){e.exports=n(13)}},[[7,1,2]]]);
//# sourceMappingURL=main.0c89b5de.chunk.js.map